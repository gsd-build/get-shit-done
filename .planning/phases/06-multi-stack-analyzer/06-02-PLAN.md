---
phase: 06-multi-stack-analyzer
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - hooks/lib/stack-profiles.yaml
autonomous: true

must_haves:
  truths:
    - "YAML file defines profiles for 24+ primary language stacks"
    - "Each stack has: globs, excludes, export_patterns, import_patterns, naming conventions"
    - "Framework-specific patterns nested under each stack"
    - "Structure is lazy-loadable (only detected stacks need to be parsed)"
  artifacts:
    - path: "hooks/lib/stack-profiles.yaml"
      provides: "Multi-language stack configuration with patterns for entity extraction"
      min_lines: 1000
  key_links:
    - from: "hooks/lib/stack-profiles.yaml"
      to: "hooks/lib/get-stack-profile.js"
      via: "Parsed by get-stack-profile.js helper"
      pattern: "yaml.load"
    - from: "hooks/lib/stack-profiles.yaml"
      to: "agents/gsd-intel-stack-analyzer.md"
      via: "Loaded by subagent for pattern matching"
      pattern: "stack-profiles.yaml"
---

# Plan 06-02: Stack Profiles Configuration

<objective>
Create `hooks/lib/stack-profiles.yaml` - comprehensive configuration for 24+ language stacks with export/import patterns, naming conventions, and framework-specific settings.

Purpose: Provide the pattern library that enables accurate extraction of exports, imports, and naming conventions across all major programming languages. Profiles are loaded lazily (only detected stacks) to minimize context usage.

Output: `hooks/lib/stack-profiles.yaml` (~1200 lines)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-multi-stack-analyzer/06-RESEARCH.md

Reference implementation (read via git show):
```bash
git show feature/multi-stack-analyzer:proposals/multi-stack-analyzer/implementation/stack-profiles.yaml
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create stack-profiles.yaml with JS/TS ecosystem</name>
  <files>hooks/lib/stack-profiles.yaml</files>
  <action>
Create the stack-profiles.yaml file with the JavaScript/TypeScript ecosystem profiles. This is the foundation - the most important stacks for GSD's current user base.

**Copy from reference implementation:**
```bash
git show feature/multi-stack-analyzer:proposals/multi-stack-analyzer/implementation/stack-profiles.yaml
```

**Structure for each stack:**
```yaml
stackname:
  display_name: "Human Name"
  marker_files: ["package.json", ...]
  globs: ["**/*.js", ...]
  excludes: ["**/node_modules/**", ...]
  export_patterns:
    - pattern: 'regex pattern'
      type: function|class|interface|constant
      scope: public|private
  import_patterns:
    - pattern: 'regex pattern'
      type: es6|commonjs|dynamic
  naming:
    functions: camelCase
    classes: PascalCase
    constants: SCREAMING_SNAKE_CASE
    variables: camelCase
    files: kebab-case
  directories:
    src: "Source code"
    lib: "Library code"
    tests: "Test files"
  frameworks:
    react:
      markers: ["**/*.jsx"]
      package_deps: ["react", "react-dom"]
      directories:
        components: "React components"
```

**First batch - JavaScript/TypeScript ecosystem:**
- javascript (with React, Vue, Angular, Express, NestJS, Svelte frameworks)
- typescript (with React, Next.js, NestJS, Angular frameworks)

These are the most detailed profiles since they're GSD's current primary use case.
  </action>
  <verify>
```bash
# Verify file exists
ls -la hooks/lib/stack-profiles.yaml

# Check it has javascript and typescript sections
grep -n "^javascript:" hooks/lib/stack-profiles.yaml
grep -n "^typescript:" hooks/lib/stack-profiles.yaml

# Verify YAML is valid (basic check)
head -100 hooks/lib/stack-profiles.yaml
```
  </verify>
  <done>stack-profiles.yaml exists with javascript and typescript profiles</done>
</task>

<task type="auto">
  <name>Task 2: Add Python, C#, and PowerShell ecosystems</name>
  <files>hooks/lib/stack-profiles.yaml</files>
  <action>
Append profiles for Python, C#, and PowerShell ecosystems to stack-profiles.yaml.

**Python ecosystem:**
```yaml
python:
  display_name: "Python"
  marker_files: ["requirements.txt", "setup.py", "pyproject.toml", "Pipfile"]
  globs: ["**/*.py", "**/*.pyi"]
  excludes: ["**/__pycache__/**", "**/venv/**", "**/env/**", "**/.venv/**"]
  export_patterns:
    - pattern: '^def\s+(\w+)\s*\('
      type: function
    - pattern: '^class\s+(\w+)'
      type: class
    - pattern: '^async\s+def\s+(\w+)'
      type: async_function
    - pattern: '__all__\s*=\s*\[.*?\]'
      type: public_api
  import_patterns:
    - pattern: 'from\s+([\w.]+)\s+import'
      type: from_import
    - pattern: 'import\s+([\w.]+)'
      type: import
  naming:
    functions: snake_case
    classes: PascalCase
    constants: SCREAMING_SNAKE_CASE
    variables: snake_case
    modules: snake_case
  frameworks:
    django: { markers: ["manage.py"], package_deps: ["django"] }
    flask: { markers: ["app.py"], package_deps: ["flask"] }
    fastapi: { package_deps: ["fastapi"] }
```

**C# ecosystem:**
```yaml
csharp:
  display_name: "C#"
  marker_files: ["*.csproj", "*.sln", "global.json"]
  globs: ["**/*.cs", "**/*.csx"]
  excludes: ["**/bin/**", "**/obj/**", "**/packages/**"]
  export_patterns:
    - pattern: 'public\s+(?:static\s+)?class\s+(\w+)'
      type: class
    - pattern: 'public\s+interface\s+(\w+)'
      type: interface
    - pattern: 'public\s+enum\s+(\w+)'
      type: enum
  naming:
    classes: PascalCase
    interfaces: IPascalCase
    methods: PascalCase
    properties: PascalCase
    fields: _camelCase
  frameworks:
    aspnetcore: { markers: ["Program.cs"], package_deps: ["Microsoft.AspNetCore"] }
    blazor: { markers: ["**/*.razor"], package_deps: ["Microsoft.AspNetCore.Components"] }
    entityframework: { markers: ["*DbContext.cs"], package_deps: ["Microsoft.EntityFrameworkCore"] }
```

**PowerShell ecosystem:**
```yaml
powershell:
  display_name: "PowerShell"
  marker_files: ["*.psd1", "*.psm1"]
  globs: ["**/*.ps1", "**/*.psm1", "**/*.psd1"]
  excludes: []
  export_patterns:
    - pattern: 'function\s+(\w+-\w+)'
      type: function
    - pattern: 'Export-ModuleMember.*-Function\s+(\w+)'
      type: exported_function
  naming:
    functions: Verb-Noun
    variables: $PascalCase
    parameters: PascalCase
  frameworks:
    pester: { markers: ["*.Tests.ps1"], patterns: ["Describe", "It", "Context"] }
```
  </action>
  <verify>
```bash
# Check Python, C#, PowerShell sections exist
grep -n "^python:" hooks/lib/stack-profiles.yaml
grep -n "^csharp:" hooks/lib/stack-profiles.yaml
grep -n "^powershell:" hooks/lib/stack-profiles.yaml

# Count total lines (should be growing)
wc -l hooks/lib/stack-profiles.yaml
```
  </verify>
  <done>stack-profiles.yaml includes Python, C#, and PowerShell profiles</done>
</task>

<task type="auto">
  <name>Task 3: Add remaining language ecosystems</name>
  <files>hooks/lib/stack-profiles.yaml</files>
  <action>
Append the remaining language profiles from the reference implementation. These include:

**Systems languages:**
- go (Go/Golang)
- rust
- c
- cpp (C++)

**JVM languages:**
- java
- kotlin
- scala
- clojure
- groovy

**Ruby ecosystem:**
- ruby (with Rails framework)

**PHP ecosystem:**
- php (with Laravel, Symfony frameworks)

**Mobile:**
- swift
- objective-c

**Functional:**
- fsharp (F#)
- haskell
- elixir
- erlang

**Other:**
- sql
- shell (bash/sh)
- lua
- perl
- r
- dart (with Flutter framework)
- zig
- nim
- ocaml

Copy these sections from the reference implementation:
```bash
git show feature/multi-stack-analyzer:proposals/multi-stack-analyzer/implementation/stack-profiles.yaml
```

Each profile should have at minimum:
- display_name
- marker_files
- globs
- excludes
- export_patterns (at least 2-3 patterns)
- import_patterns (at least 1-2 patterns)
- naming conventions
  </action>
  <verify>
```bash
# Check several more stacks exist
grep -n "^go:" hooks/lib/stack-profiles.yaml
grep -n "^rust:" hooks/lib/stack-profiles.yaml
grep -n "^java:" hooks/lib/stack-profiles.yaml
grep -n "^ruby:" hooks/lib/stack-profiles.yaml
grep -n "^php:" hooks/lib/stack-profiles.yaml
grep -n "^swift:" hooks/lib/stack-profiles.yaml

# Verify total line count (~1000-1200 lines expected)
wc -l hooks/lib/stack-profiles.yaml

# Validate YAML structure (should not have syntax errors)
node -e "require('js-yaml').load(require('fs').readFileSync('hooks/lib/stack-profiles.yaml', 'utf8'))" 2>&1 || echo "YAML validation requires js-yaml - visual inspection OK"
```
  </verify>
  <done>stack-profiles.yaml contains 24+ language profiles with complete pattern definitions</done>
</task>

</tasks>

<verification>
- [ ] `hooks/lib/stack-profiles.yaml` exists
- [ ] JavaScript and TypeScript profiles are complete with framework detection
- [ ] Python, C#, PowerShell profiles included
- [ ] 24+ total language profiles defined
- [ ] Each profile has: display_name, marker_files, globs, excludes, export_patterns, import_patterns, naming
- [ ] File is ~1000-1200 lines
</verification>

<success_criteria>
- stack-profiles.yaml is valid YAML (or at least parseable by simple YAML parser)
- Contains profiles for: javascript, typescript, python, csharp, powershell, go, rust, java, kotlin, ruby, php, swift (minimum 12)
- Each profile has export_patterns with regex patterns for function/class/etc detection
- Each profile has naming conventions appropriate for that language
- Framework-specific settings nested under relevant stacks
</success_criteria>

<output>
After completion, create `.planning/phases/06-multi-stack-analyzer/06-02-SUMMARY.md`
</output>
