---
phase: 02-polish
plan: 01
type: execute
wave: 1
depends_on: ["01-02"]
files_modified:
  - bin/install.js
autonomous: true

must_haves:
  truths:
    - "Cursor installation skips hook file deployment"
    - "Cursor installation skips hooks configuration in settings.json"
    - "Cursor installation skips statusline prompt"
    - "convertClaudeToCursorFrontmatter removes name: field"
    - "convertClaudeToCursorFrontmatter replaces /clear with new chat instruction"
  artifacts:
    - path: "bin/install.js"
      provides: "Cursor-specific hook and conversion handling"
      contains: "isCursor.*skip.*hook"
  key_links:
    - from: "install()"
      to: "hook deployment"
      via: "isCursor check"
      pattern: "isCursor.*hooks"
---

<objective>
Update installer to skip hooks for Cursor and enhance frontmatter conversion.

Purpose: Based on Phase 2 research, Cursor has no statusline and no notification API. Hooks serve no purpose for Cursor. Also fixes autocomplete by removing name: field and updates /clear references.

Output: Cursor installation that:
1. Skips hook file deployment
2. Skips hooks configuration in settings.json
3. Skips statusline prompt
4. Removes name: field from frontmatter (autocomplete fix)
5. Replaces /clear with Cursor-appropriate instruction
</objective>

<execution_context>
@~/.cursor/get-shit-done/workflows/execute-plan.md
@~/.cursor/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-polish/research/SUMMARY.md
@bin/install.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Skip hooks for Cursor installation</name>
  <files>bin/install.js</files>
  <action>
**1. Update install() to skip hook file copying for Cursor**

Find the hook copying section (around line 1380-1410) where hooks are copied.
Add Cursor check to skip hook deployment:

```javascript
// Copy hooks (skip for Cursor - no statusline/notification support)
if (!isCursor) {
  // existing hook copying code
}
```

**2. Update install() to skip hooks configuration in settings.json**

Find the SessionStart hook configuration (around line 1450-1474).
The current check is `if (!isOpencode)`. Change to:

```javascript
// Configure SessionStart hook for update checking (skip for opencode and cursor)
if (!isOpencode && !isCursor) {
  // existing hook configuration code
}
```

**3. Update installAllRuntimes() to skip statusline prompt for Cursor-only**

Find the statusline handling (around line 1665-1696).
Update the condition to exclude Cursor-only installations from statusline prompt:

The current logic checks `if (claudeResult || geminiResult || cursorResult)` for statusline prompt.
Change `cursorResult` handling - Cursor should NOT trigger statusline prompt:

```javascript
// Handle statusline for Claude & Gemini only (OpenCode uses themes, Cursor has no statusline)
const claudeResult = results.find(r => r.runtime === 'claude');
const geminiResult = results.find(r => r.runtime === 'gemini');
const cursorResult = results.find(r => r.runtime === 'cursor');

if (claudeResult || geminiResult) {
  // Statusline prompt for Claude/Gemini
  const primaryResult = claudeResult || geminiResult;
  
  handleStatusline(primaryResult.settings, isInteractive, (shouldInstallStatusline) => {
    if (claudeResult) {
      finishInstall(claudeResult.settingsPath, claudeResult.settings, claudeResult.statuslineCommand, shouldInstallStatusline, 'claude');
    }
    if (geminiResult) {
      finishInstall(geminiResult.settingsPath, geminiResult.settings, geminiResult.statuslineCommand, shouldInstallStatusline, 'gemini');
    }
    // Cursor: no statusline
    if (cursorResult) {
      finishInstall(cursorResult.settingsPath, cursorResult.settings, cursorResult.statuslineCommand, false, 'cursor');
    }
    // OpenCode: no statusline
    const opencodeResult = results.find(r => r.runtime === 'opencode');
    if (opencodeResult) {
      finishInstall(opencodeResult.settingsPath, opencodeResult.settings, opencodeResult.statuslineCommand, false, 'opencode');
    }
  });
} else {
  // Only OpenCode and/or Cursor - no statusline prompt needed
  for (const result of results) {
    finishInstall(result.settingsPath, result.settings, result.statuslineCommand, false, result.runtime);
  }
}
```
  </action>
  <verify>
Run `node -c bin/install.js` to verify syntax.
Search for "isCursor" near hook-related code to confirm changes.
  </verify>
  <done>
- Hook file deployment skipped for Cursor
- SessionStart hook configuration skipped for Cursor
- Statusline prompt skipped for Cursor-only installations
- HOOK-01, HOOK-02, HOOK-03 requirements addressed (by skipping)
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance Cursor frontmatter conversion</name>
  <files>bin/install.js</files>
  <action>
**1. Ensure name: field is removed in convertClaudeToCursorFrontmatter()**

The function already has code to remove `name:` field. Verify it works:
```javascript
// Remove name: field - Cursor uses filename for command name
if (trimmed.startsWith('name:')) {
  continue;
}
```

If not present, add this in the frontmatter parsing loop.

**2. Add /clear replacement in convertClaudeToCursorFrontmatter()**

Add this replacement after the existing path replacements (after `~/.claude/` → `~/.cursor/`):

```javascript
// Replace /clear with Cursor-appropriate instruction
// Cursor has no /clear command - users click "+" button for new chat
convertedContent = convertedContent.replace(
  /`\/clear`\s*(?:first\s*)?→?\s*fresh context window/gi,
  'Click "+" (new chat) → fresh context window'
);
convertedContent = convertedContent.replace(
  /<sub>`\/clear`/gi,
  '<sub>Click "+" (new chat)'
);
// Handle standalone /clear references
convertedContent = convertedContent.replace(
  /(?<![`\/\w])\/clear(?![`\w])/g,
  'new chat (click "+")'
);
```

**3. Update /gsd:update reference in body text**

The statusline shows `/gsd:update` but Cursor uses `/gsd-update` format.
This should already be handled by the `/gsd:` → `/gsd-` replacement, but verify.
  </action>
  <verify>
Run `node -c bin/install.js` to verify syntax.
Test the conversion function with sample content containing:
- `name:` field in frontmatter
- `/clear first → fresh context window`
- `<sub>/clear</sub>`
  </verify>
  <done>
- `name:` field removal confirmed/added
- `/clear` references replaced with Cursor new chat instructions
- Autocomplete should work with `/gsd/` prefix (needs manual testing)
  </done>
</task>

</tasks>

<verification>
1. `node -c bin/install.js` passes (no syntax errors)
2. Hook-related code has `isCursor` checks
3. `convertClaudeToCursorFrontmatter` removes `name:` field
4. `convertClaudeToCursorFrontmatter` replaces `/clear` references
</verification>

<success_criteria>
- [ ] Cursor installation skips hook file deployment
- [ ] Cursor installation skips hooks configuration in settings.json
- [ ] Cursor installation skips statusline prompt
- [ ] `name:` field removed during Cursor conversion
- [ ] `/clear` replaced with new chat instruction
- [ ] `node -c bin/install.js` passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-polish/02-01-SUMMARY.md`
</output>
